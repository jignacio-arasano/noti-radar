<<!-- templates/fragments.html -->
<!-- src/main/resources/templates/fragments.html -->
<head xmlns:th="http://www.thymeleaf.org" th:fragment="head">
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title th:text="${title} ?: 'Redacci√≥n Monitor'">Redacci√≥n Monitor</title>

  <style>
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --border:#e5e7eb;
      --brand:#2563eb;
      --brand-600:#1d4ed8;
      --ok:#16a34a;
      --err:#dc2626;
      --warn:#d97706;
      --shadow:0 6px 18px rgba(0,0,0,.06);
      --radius:16px;
      --radius-sm:10px;
      --pad:16px;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0f1116;
        --card:#161a22;
        --text:#e5e7eb;
        --muted:#9ca3af;
        --border:#232938;
        --brand:#3b82f6;
        --brand-600:#2563eb;
        --shadow:0 8px 20px rgba(0,0,0,.35);
      }
    }

    *{box-sizing:border-box; min-width:0}
    html,body{
      margin:0; padding:0; background:var(--bg); color:var(--text);
      font: clamp(14px, 0.35vw + 13px, 16px)/1.5 ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial;
    }
    a{color:var(--brand);text-decoration:none}
    a:hover{text-decoration:underline}

    .container{
      width:100%;
      max-width: min(1240px, 100% - clamp(24px, 6vw, 64px));
      margin-inline:auto;
      padding-inline: clamp(12px, 2.5vw, 28px);
      padding-block: clamp(8px, 1.5vw, 18px);
    }

    .app-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800;font-size:clamp(18px,1.1vw+16px,22px)}
    .brand .logo{
      width:36px;height:36px;border-radius:10px;
      background:linear-gradient(145deg,var(--brand),var(--brand-600));box-shadow:var(--shadow);
      display:grid;place-items:center;color:#fff;font-weight:900;flex:0 0 auto;
    }
    .nav-actions{display:flex;align-items:center;gap:10px;flex-wrap:wrap}

    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      box-shadow:var(--shadow); width:100%;
    }
    .card .card-header{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      padding: clamp(12px, 1.8vw, 18px) clamp(12px, 2vw, 20px) 0;
      flex-wrap:wrap;
    }
    .card .card-body{
      padding: clamp(12px, 2vw, 20px);
    }

    .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .spacer{flex:1 1 auto}

    .btn{
      appearance:none;border:1px solid var(--border);background:var(--card);color:var(--text);
      padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;
      display:inline-flex;gap:8px;align-items:center;box-shadow:var(--shadow);line-height:1;
    }
    .btn:hover{filter:brightness(0.98)}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--brand);border-color:transparent;color:#fff}
    .btn-primary:hover{background:var(--brand-600)}
    .btn-ghost{background:transparent;border-color:var(--border);box-shadow:none}
    .btn-danger{background:#fee2e2;border-color:#fecaca;color:#991b1b}
    @media (prefers-color-scheme: dark){
      .btn-danger{background:#2a1517;border-color:#4d1e23;color:#fca5a5}
    }

    .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;border-radius:999px;font-weight:800;font-size:12px;border:1px solid transparent}
    .badge-ok{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
    .badge-err{background:#fef2f2;color:#991b1b;border-color:#fecaca}
    .badge-warn{background:#fffbeb;color:#92400e;border-color:#fde68a}
    @media (prefers-color-scheme: dark){
      .badge-ok{background:#0b2d22;color:#a7f3d0;border-color:#134e4a}
      .badge-err{background:#2a1517;color:#fca5a5;border-color:#7f1d1d}
      .badge-warn{background:#2b2412;color:#fde68a;border-color:#78350f}
    }

    .searchbar{position:relative;min-width:260px;flex:1 1 260px}
    .searchbar input{
      width:100%;padding:12px 12px 12px 36px;border-radius:12px;border:1px solid var(--border);
      background:var(--bg);color:var(--text);
    }
    .searchbar .icon{position:absolute;left:10px;top:50%;transform:translateY(-50%);opacity:.6}

    .table-wrap{
      overflow:auto;
      border:1px solid var(--border);border-radius:var(--radius);background:var(--card);box-shadow:var(--shadow);
      width:100%;
    }
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{
      position:sticky;top:0;background:linear-gradient(#f9fafb,#f3f4f6);color:#111827;
      border-bottom:1px solid var(--border);text-align:left;padding:12px;font-size:13px;letter-spacing:.02em;z-index:1;
    }
    @media (prefers-color-scheme: dark){
      thead th{background:linear-gradient(#1a1f2b,#151a23);color:#e5e7eb}
    }
    tbody td{border-bottom:1px solid var(--border);padding:12px;vertical-align:middle}
    tbody tr:hover{background:rgba(0,0,0,.02)}
    @media (prefers-color-scheme: dark){ tbody tr:hover{background:rgba(255,255,255,.03)} }
    td.actions{white-space:nowrap}
    .mono{font-family:ui-monospace,Consolas,Menlo,monospace}

    /* ajustes base para pantallas chicas */
    @media (max-width:760px){
      .col-id{display:none}
      .btn .txt{display:none}
      .searchbar{min-width:180px}
    }

    .hint{font-size:12px;color:var(--muted)}
    .grid-fit{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(min(320px,100%),1fr))}

    /* ======= MODO M√ìVIL (vertical) ======= */
    @media (max-width: 760px){

      /* Header pegado arriba y navegaci√≥n ‚Äúa la mano‚Äù */
      .app-header{position: sticky; top: 0; z-index: 50; background: var(--bg); padding-block: 8px}
      .nav-actions{width:100%; overflow:auto; -webkit-overflow-scrolling: touch; gap:8px}
      .nav-actions .btn{flex:0 0 auto}

      /* Toolbars compactas y usables con pulgar */
      .card .card-header{gap:12px}
      .toolbar{width:100%; align-items:stretch; gap:8px}
      .searchbar{order:2; flex:1 1 100%; min-width:0}
      .toolbar .btn{flex:1 1 0; justify-content:center}
      .btn .txt{display:none} /* deja solo √≠conos en botones */

      /* Tablas -> tarjetas apiladas (Pages y Versions) */
      .table-wrap{border:none; background:transparent; box-shadow:none}
      table{display:block; width:100%}
      thead{display:none}
      tbody{display:grid; gap:12px}
      tbody tr{
        display:grid; gap:10px;
        padding:12px; border:1px solid var(--border);
        border-radius: var(--radius-sm); background: var(--card); box-shadow: var(--shadow);
      }
      tbody td{
        display:grid; grid-template-columns: 120px 1fr; align-items:center;
        border:0; padding:6px 0;
      }
      tbody td::before{
        content:''; /* se sobreescribe por tabla abajo */
        font-weight:800; color:var(--muted);
        padding-right:10px;
      }

      /* -------- P√°ginas (pagesTable) -------- */
      #pagesTable .col-id{display:none}          /* escond√© ID */
      #pagesTable td:nth-child(2)::before{content:"URL"}
      #pagesTable td:nth-child(3)::before{content:"√öltimo chequeo"}
      #pagesTable td:nth-child(4)::before{content:"√öltima modificaci√≥n"}
      #pagesTable td:nth-child(5)::before{content:"Estado"}
      #pagesTable td:nth-child(6)::before{content:"Acciones"}

      /* Acciones: botones grandes y en columna */
      #pagesTable td.actions{grid-template-columns:1fr}
      #pagesTable td.actions .btn{width:100%; justify-content:center; margin-bottom:8px}
      #pagesTable td.actions .btn:last-child{margin-bottom:0}

      /* Fila vac√≠a (colspan) que muestre el mensaje centrado */
      #pagesTable td[colspan]{grid-template-columns:1fr; padding:14px}
      #pagesTable td[colspan]::before{content:''; display:none}

      /* -------- Versiones (versionsTable) -------- */
      #versionsTable td:nth-child(1)::before{content:"Fecha"}
      #versionsTable td:nth-child(2)::before{content:"Hash"}
      #versionsTable td:nth-child(3)::before{content:"Acciones"}
      #versionsTable td.actions{grid-template-columns:1fr}
      #versionsTable td.actions .btn{width:100%; justify-content:center}

      /* -------- Diff (ya se apila; afinamos altura y controles) -------- */
      .diff-grid{grid-template-columns:1fr}
      .diff-pre{max-height:60vh} /* m√°s aire de lectura en m√≥vil */
      #wrapBtn,#syncBtn{flex:1 1 0} /* botones m√°s anchos para tap */

      /* Peque√±as mejoras t√°ctiles */
      .btn{padding:12px 14px; border-radius:14px}
      .searchbar input{padding:12px 12px 12px 36px}
      tbody tr:hover{background:rgba(0,0,0,.015)}
      @media (prefers-color-scheme: dark){
        tbody tr:hover{background:rgba(255,255,255,.03)}
      }
    }
    /* ======= FIN MODO M√ìVIL ======= */
  </style>

  <script>
    // Tooltip "hace X" en todos los <time datetime="...">
    document.addEventListener('DOMContentLoaded', () => {
      const rtf = new Intl.RelativeTimeFormat('es-AR', { numeric: 'auto' });
      const MIN = 60 * 1000, H = 60 * MIN, D = 24 * H;
      const rel = (d) => {
        const diff = Date.now() - d.getTime(), abs = Math.abs(diff);
        if (abs < H) return rtf.format(Math.round(-diff / MIN), 'minute');
        if (abs < D) return rtf.format(Math.round(-diff / H), 'hour');
        return rtf.format(Math.round(-diff / D), 'day');
      };
      document.querySelectorAll('time[datetime]').forEach(t => {
        const iso = t.getAttribute('datetime'); if (!iso) return;
        const d = new Date(iso); t.title = rel(d);
      });
    });
  </script>
</head>

<header xmlns:th="http://www.thymeleaf.org" th:fragment="navbar">
  <div class="container app-header">
    <div class="brand">
      <div class="logo" aria-hidden="true">üì∞</div>
      <span>Redacci√≥n Monitor</span>
    </div>
    <nav class="nav-actions">
      <a class="btn btn-ghost" href="/pages">P√°ginas</a>
      <a class="btn btn-ghost" href="/pages/new">Agregar URL</a>
      <a class="btn btn-ghost" href="/settings">Settings</a>
      <!-- H2 oculto: enlace removido -->
    </nav>
  </div>
</header>


